sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/core/Messaging","sap/ui/core/message/Message","sap/m/MessageToast","sap/ui/core/library","sap/m/MessagePopover","sap/m/MessageItem","hackathon/valuesphere/cashflow/forecast/ext/utils/SpreadsheetHelper"],function(e,s,t,o,a,n,r,i,c,u){"use strict";return e.extend("hackathon.valuesphere.cashflow.forecast.ext.controller.ListReportExtension",{override:{onInit:function(){this.oView=this.getView();this.oResourceBundle=this.base.getResourceBundle();this.oMessageModel=o.getMessageModel();this.oView.setModel(this.oMessageModel,"message");u.init(this.oResourceBundle)}},onTableSelectionChange:function(e){const s=e.getSource();const t=s.getSelectedContexts();console.log("Selection changed. Selected rows:",aSelectedIndices.length);if(aSelectedIndices.length>0){n.show(aSelectedIndices.length+" items selected")}},onApprove:function(){this._updateItemsStatus("APPROVED")},onReject:function(){this._updateItemsStatus("REJECTED")},_updateItemsStatus:function(e){const s="hackathon.valuesphere.cashflow.forecast::CashflowWeeklyForecastsList--fe::table::CashflowWeeklyForecasts::LineItem-innerTable";const t=sap.ui.getCore().byId(s);if(!t){sap.m.MessageToast.show("Table not found");return}const o=t._getSelectionPlugin().getSelectedContexts();if(!o||o.length===0){sap.m.MessageToast.show("No items selected");return}sap.ui.core.BusyIndicator.show(0);const a=this.getView().getModel();const n="statusUpdateBatch";try{if(typeof a.setDeferredGroups==="function"){a.setDeferredGroups([n])}}catch(e){console.log("Deferred groups not supported, using standard updates")}const r=[];o.forEach(s=>{try{const t=s.setProperty("status",e,n);r.push(t)}catch(t){const o=s.setProperty("status",e);r.push(o)}});let i;if(typeof a.submitBatch==="function"){i=a.submitBatch(n)}else{i=Promise.all(r)}i.then(()=>{sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show(`${o.length} items successfully ${e.toLowerCase()}`);t.getBinding("rows").refresh()}).catch(e=>{sap.ui.core.BusyIndicator.hide();sap.m.MessageBox.error(`Error updating items: ${e.message||"Unknown error"}`);console.error("Error updating items:",e);t.getBinding("rows").refresh()})},onMassUpload:function(){this._updateItemsStatus("NEW")},onSpreadsheetDialogClose:function(){this._spreadsheetDialog.close();this._spreadsheetDialog.destroy()}})});
//# sourceMappingURL=ListReportExtension.controller.js.map